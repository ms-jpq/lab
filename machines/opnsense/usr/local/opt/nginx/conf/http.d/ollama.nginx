server {
  listen unix:/run/local/nginx/ollama.sock;
  set    $x_esxi esxi.enp1s0.opnsense.home.arpa;

  location / {
    auth_basic           "-";
    auth_basic_user_file /var/lib/local/nginx/ollama.htpasswd;
    proxy_pass           http://$x_esxi:11434;
  }
}

server {
  server_name ollama.*;
  listen      unix:/run/local/nginx/gateway-https.sock;

  location / {
    proxy_set_header Authorization $modified_auth;
    include          /usr/local/opt/nginx/conf/http.d/proxy_params.nginx;
    proxy_pass       http://unix:/run/local/nginx/ollama.sock:/;
  }
}