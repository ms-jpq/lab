frontend ft_tcp1080
  mode            tcp
  bind            [::]:1080
  option          tcplog
  default_backend bk_socks5

  acl CONNECT payload(0,7) -m str -- CONNECT-
  use_backend bk_http5 if CONNECT

frontend ft_unix1080
  mode            tcp
  bind            unix@/run/haproxy/httpsocks-1080.sock
  option          tcplog
  default_backend bk_socks5

  acl CONNECT payload(0,7) -m str -- CONNECT-
  use_backend bk_http5 if CONNECT

backend bk_socks5
  mode   tcp
  server socks5 127.0.0.1:40000

backend bk_http5
  mode   tcp
  server http5 127.0.0.53:40000
